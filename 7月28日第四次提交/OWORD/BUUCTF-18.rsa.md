# BUUCTF-18.rsa

借助本题记录一下rsa加密的解密过程

RSA加密[算法](https://www.mochoublog.com/tags-算法-0.html)是一种非对称加密算法，是一种“由已知加密密钥推导出解密密钥在计算上是不可行的”密码体制。在公开密钥密码体制中，加密密钥（即公开密钥）PK是公开信息，而解密密钥（即秘密密钥）SK是需要保密的。加密算法E和解密算法D也都是公开的。虽然解密密钥SK是由公开密钥PK决定的，由于无法计算出大数n的欧拉函数phi(N)，所以不能根据PK计算出SK。

RSA算法基于一个十分简单的数论事实：将两个大素数相乘十分容易，但想要对其乘积进行因式分解却极其困难，因此可以将乘积公开作为加密密钥。

RSA公钥私钥算法：

1.  选择两个不同的大素数p和q；
2.  计算公共模数（n=pq）和欧拉数（eular=(p-1)(q-1)）；
3.  选择公钥指数e；
4.  计算“模的逆元”inverse（d）；
5.  生成公钥、私钥；

解密过程：

1.  [RSA公私钥分解 Exponent、Modulus，Rsa公私钥指数、系数(模数)分解--查错网 (chacuo.net)](http://tool.chacuo.net/cryptrsakeyparse) 这个网站可以对公钥进行解析得到n和e；

2.  可以通过一个工具yafu或者：[factordb.com](http://www.factordb.com/index.php?query=86934482296048119190666062003494800588905656017203025617216654058378322103517) 这个网站，可以分解n得到p和q

3.  本题得到

    ```python
    e = 65537
    n = 86934482296048119190666062003494800588905656017203025617216654058378322103517
    p = 285960468890451637935629440372639283459
    q = 304008741604601924494328155975272418463
    ```

4.  通过python脚本解密得到flag

    ```python
    import gmpy2
    import rsa
    
    e = 65537
    n = 86934482296048119190666062003494800588905656017203025617216654058378322103517
    p = 285960468890451637935629440372639283459
    q = 304008741604601924494328155975272418463
    
    phin = (q-1)*(p-1)
    d = gmpy2.invert(e, phin)
    
    key = rsa.PrivateKey(n, e, int(d), p, q)
    
    with open("E:/ctf/BUUCTF/18.rsa/output/flag.enc", "rb+") as f:
        f = f.read()
        print(rsa.decrypt(f, key))
    ```

得到flag：flag{decrypt_256}
